<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../packages_es6/ember-routing/lib/helpers/action.js - The Ember API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="The Ember API" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0 pre</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Ember.html">Ember</a></li>
                                <li><a href="../classes/Ember._HandlebarsBoundView.html">Ember._HandlebarsBoundView</a></li>
                                <li><a href="../classes/Ember._Metamorph.html">Ember._Metamorph</a></li>
                                <li><a href="../classes/Ember._MetamorphView.html">Ember._MetamorphView</a></li>
                                <li><a href="../classes/Ember._SimpleMetamorphView.html">Ember._SimpleMetamorphView</a></li>
                                <li><a href="../classes/Ember.ActionHandler.html">Ember.ActionHandler</a></li>
                                <li><a href="../classes/Ember.Application.html">Ember.Application</a></li>
                                <li><a href="../classes/Ember.Array.html">Ember.Array</a></li>
                                <li><a href="../classes/Ember.ArrayController.html">Ember.ArrayController</a></li>
                                <li><a href="../classes/Ember.ArrayProxy.html">Ember.ArrayProxy</a></li>
                                <li><a href="../classes/Ember.AutoLocation.html">Ember.AutoLocation</a></li>
                                <li><a href="../classes/Ember.Binding.html">Ember.Binding</a></li>
                                <li><a href="../classes/Ember.Checkbox.html">Ember.Checkbox</a></li>
                                <li><a href="../classes/Ember.CollectionView.html">Ember.CollectionView</a></li>
                                <li><a href="../classes/Ember.Comparable.html">Ember.Comparable</a></li>
                                <li><a href="../classes/Ember.Component.html">Ember.Component</a></li>
                                <li><a href="../classes/Ember.ComponentTemplateDeprecation.html">Ember.ComponentTemplateDeprecation</a></li>
                                <li><a href="../classes/Ember.ComputedProperty.html">Ember.ComputedProperty</a></li>
                                <li><a href="../classes/Ember.ContainerDebugAdapter.html">Ember.ContainerDebugAdapter</a></li>
                                <li><a href="../classes/Ember.ContainerView.html">Ember.ContainerView</a></li>
                                <li><a href="../classes/Ember.Controller.html">Ember.Controller</a></li>
                                <li><a href="../classes/Ember.ControllerMixin.html">Ember.ControllerMixin</a></li>
                                <li><a href="../classes/Ember.Copyable.html">Ember.Copyable</a></li>
                                <li><a href="../classes/Ember.CoreObject.html">Ember.CoreObject</a></li>
                                <li><a href="../classes/Ember.CoreView.html">Ember.CoreView</a></li>
                                <li><a href="../classes/Ember.DataAdapter.html">Ember.DataAdapter</a></li>
                                <li><a href="../classes/Ember.DefaultResolver.html">Ember.DefaultResolver</a></li>
                                <li><a href="../classes/Ember.Deferred.html">Ember.Deferred</a></li>
                                <li><a href="../classes/Ember.Descriptor.html">Ember.Descriptor</a></li>
                                <li><a href="../classes/Ember.EachProxy.html">Ember.EachProxy</a></li>
                                <li><a href="../classes/Ember.Enumerable.html">Ember.Enumerable</a></li>
                                <li><a href="../classes/Ember.EnumerableUtils.html">Ember.EnumerableUtils</a></li>
                                <li><a href="../classes/Ember.Error.html">Ember.Error</a></li>
                                <li><a href="../classes/Ember.EventDispatcher.html">Ember.EventDispatcher</a></li>
                                <li><a href="../classes/Ember.Evented.html">Ember.Evented</a></li>
                                <li><a href="../classes/Ember.FEATURES.html">Ember.FEATURES</a></li>
                                <li><a href="../classes/Ember.Freezable.html">Ember.Freezable</a></li>
                                <li><a href="../classes/Ember.Handlebars.html">Ember.Handlebars</a></li>
                                <li><a href="../classes/Ember.Handlebars.Compiler.html">Ember.Handlebars.Compiler</a></li>
                                <li><a href="../classes/Ember.Handlebars.helpers.html">Ember.Handlebars.helpers</a></li>
                                <li><a href="../classes/Ember.Handlebars.JavaScriptCompiler.html">Ember.Handlebars.JavaScriptCompiler</a></li>
                                <li><a href="../classes/Ember.HashLocation.html">Ember.HashLocation</a></li>
                                <li><a href="../classes/Ember.HistoryLocation.html">Ember.HistoryLocation</a></li>
                                <li><a href="../classes/Ember.Instrumentation.html">Ember.Instrumentation</a></li>
                                <li><a href="../classes/Ember.LinkView.html">Ember.LinkView</a></li>
                                <li><a href="../classes/Ember.Location.html">Ember.Location</a></li>
                                <li><a href="../classes/Ember.Logger.html">Ember.Logger</a></li>
                                <li><a href="../classes/Ember.Map.html">Ember.Map</a></li>
                                <li><a href="../classes/Ember.MapWithDefault.html">Ember.MapWithDefault</a></li>
                                <li><a href="../classes/Ember.Mixin.html">Ember.Mixin</a></li>
                                <li><a href="../classes/Ember.MutableArray.html">Ember.MutableArray</a></li>
                                <li><a href="../classes/Ember.MutableEnumerable.html">Ember.MutableEnumerable</a></li>
                                <li><a href="../classes/Ember.Namespace.html">Ember.Namespace</a></li>
                                <li><a href="../classes/Ember.NativeArray.html">Ember.NativeArray</a></li>
                                <li><a href="../classes/Ember.NoneLocation.html">Ember.NoneLocation</a></li>
                                <li><a href="../classes/Ember.Object.html">Ember.Object</a></li>
                                <li><a href="../classes/Ember.ObjectController.html">Ember.ObjectController</a></li>
                                <li><a href="../classes/Ember.ObjectProxy.html">Ember.ObjectProxy</a></li>
                                <li><a href="../classes/Ember.Observable.html">Ember.Observable</a></li>
                                <li><a href="../classes/Ember.OrderedSet.html">Ember.OrderedSet</a></li>
                                <li><a href="../classes/Ember.platform.html">Ember.platform</a></li>
                                <li><a href="../classes/Ember.PromiseProxyMixin.html">Ember.PromiseProxyMixin</a></li>
                                <li><a href="../classes/Ember.ReduceComputedProperty.html">Ember.ReduceComputedProperty</a></li>
                                <li><a href="../classes/Ember.RenderBuffer.html">Ember.RenderBuffer</a></li>
                                <li><a href="../classes/Ember.Route.html">Ember.Route</a></li>
                                <li><a href="../classes/Ember.Router.html">Ember.Router</a></li>
                                <li><a href="../classes/Ember.RSVP.html">Ember.RSVP</a></li>
                                <li><a href="../classes/Ember.RSVP.EventTarget.html">Ember.RSVP.EventTarget</a></li>
                                <li><a href="../classes/Ember.RSVP.Promise.html">Ember.RSVP.Promise</a></li>
                                <li><a href="../classes/Ember.Select.html">Ember.Select</a></li>
                                <li><a href="../classes/Ember.Set.html">Ember.Set</a></li>
                                <li><a href="../classes/Ember.SortableMixin.html">Ember.SortableMixin</a></li>
                                <li><a href="../classes/Ember.State.html">Ember.State</a></li>
                                <li><a href="../classes/Ember.StateManager.html">Ember.StateManager</a></li>
                                <li><a href="../classes/Ember.String.html">Ember.String</a></li>
                                <li><a href="../classes/Ember.SubArray.html">Ember.SubArray</a></li>
                                <li><a href="../classes/Ember.TargetActionSupport.html">Ember.TargetActionSupport</a></li>
                                <li><a href="../classes/Ember.Test.html">Ember.Test</a></li>
                                <li><a href="../classes/Ember.Test.Adapter.html">Ember.Test.Adapter</a></li>
                                <li><a href="../classes/Ember.Test.QUnitAdapter.html">Ember.Test.QUnitAdapter</a></li>
                                <li><a href="../classes/Ember.TextArea.html">Ember.TextArea</a></li>
                                <li><a href="../classes/Ember.TextField.html">Ember.TextField</a></li>
                                <li><a href="../classes/Ember.TextSupport.html">Ember.TextSupport</a></li>
                                <li><a href="../classes/Ember.TrackedArray.html">Ember.TrackedArray</a></li>
                                <li><a href="../classes/Ember.View.html">Ember.View</a></li>
                                <li><a href="../classes/Ember.ViewTargetActionSupport.html">Ember.ViewTargetActionSupport</a></li>
                                <li><a href="../classes/Function.html">Function</a></li>
                                <li><a href="../classes/run.run.html">run.run</a></li>
                                <li><a href="../classes/String.html">String</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ember.html">ember</a></li>
                                <li><a href="../modules/ember-application.html">ember-application</a></li>
                                <li><a href="../modules/ember-debug.html">ember-debug</a></li>
                                <li><a href="../modules/ember-extension-support.html">ember-extension-support</a></li>
                                <li><a href="../modules/ember-handlebars.html">ember-handlebars</a></li>
                                <li><a href="../modules/ember-handlebars-compiler.html">ember-handlebars-compiler</a></li>
                                <li><a href="../modules/ember-metal.html">ember-metal</a></li>
                                <li><a href="../modules/ember-routing.html">ember-routing</a></li>
                                <li><a href="../modules/ember-runtime.html">ember-runtime</a></li>
                                <li><a href="../modules/ember-testing.html">ember-testing</a></li>
                                <li><a href="../modules/ember-views.html">ember-views</a></li>
                                <li><a href="../modules/RSVP.html">RSVP</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ../packages_es6/ember-routing/lib/helpers/action.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Ember from &quot;ember-metal/core&quot;; // Handlebars, uuid, FEATURES, assert, deprecate
import {get} from &quot;ember-metal/property_get&quot;;
import {forEach} from &quot;ember-metal/array&quot;;
import run from &quot;ember-metal/run_loop&quot;;

import {isSimpleClick} from &quot;ember-views/system/utils&quot;;
import EmberHandlebars from &quot;ember-handlebars&quot;;
import EmberRouter from &quot;ember-routing/system/router&quot;;


import EmberHandlebars from &quot;ember-handlebars&quot;;
import {handlebarsGet} from &quot;ember-handlebars/ext&quot;;
import {viewHelper} from &quot;ember-handlebars/helpers/view&quot;;
import {resolveParams, resolvePath} from &quot;ember-routing/helpers/shared&quot;;

// requireModule(&#x27;ember-handlebars&#x27;);

/**
@module ember
@submodule ember-routing
*/

var SafeString = EmberHandlebars.SafeString,
    a_slice = Array.prototype.slice;

function args(options, actionName) {
  var ret = [];
  if (actionName) { ret.push(actionName); }

  var types = options.options.types.slice(1),
      data = options.options.data;

  return ret.concat(resolveParams(options.context, options.params, { types: types, data: data }));
}

var ActionHelper = {
  registeredActions: {}
};

var keys = [&quot;alt&quot;, &quot;shift&quot;, &quot;meta&quot;, &quot;ctrl&quot;];

var POINTER_EVENT_TYPE_REGEX = /^click|mouse|touch/;

var isAllowedEvent = function(event, allowedKeys) {
  if (typeof allowedKeys === &quot;undefined&quot;) {
    if (POINTER_EVENT_TYPE_REGEX.test(event.type)) {
      return isSimpleClick(event);
    } else {
      allowedKeys = &#x27;&#x27;;
    }
  }

  if (allowedKeys.indexOf(&quot;any&quot;) &gt;= 0) {
    return true;
  }

  var allowed = true;

  forEach.call(keys, function(key) {
    if (event[key + &quot;Key&quot;] &amp;&amp; allowedKeys.indexOf(key) === -1) {
      allowed = false;
    }
  });

  return allowed;
};

ActionHelper.registerAction = function(actionNameOrPath, options, allowedKeys) {
  var actionId = ++Ember.uuid;

  ActionHelper.registeredActions[actionId] = {
    eventName: options.eventName,
    handler: function handleRegisteredAction(event) {
      if (!isAllowedEvent(event, allowedKeys)) { return true; }

      if (options.preventDefault !== false) {
        event.preventDefault();
      }

      if (options.bubbles === false) {
        event.stopPropagation();
      }

      var target = options.target,
          parameters = options.parameters,
          actionName;

      if (target.target) {
        target = handlebarsGet(target.root, target.target, target.options);
      } else {
        target = target.root;
      }

      if (options.boundProperty) {
        actionName = resolveParams(parameters.context, [actionNameOrPath], { types: [&#x27;ID&#x27;], data: parameters.options.data })[0];

        if(typeof actionName === &#x27;undefined&#x27; || typeof actionName === &#x27;function&#x27;) {
          Ember.assert(&quot;You specified a quoteless path to the {{action}} helper &#x27;&quot; + actionNameOrPath + &quot;&#x27; which did not resolve to an actionName. Perhaps you meant to use a quoted actionName? (e.g. {{action &#x27;&quot; + actionNameOrPath + &quot;&#x27;}}).&quot;, true);
          actionName = actionNameOrPath;
        }
      }

      if (!actionName) {
        actionName = actionNameOrPath;
      }

      run(function runRegisteredAction() {
        if (target.send) {
          target.send.apply(target, args(parameters, actionName));
        } else {
          Ember.assert(&quot;The action &#x27;&quot; + actionName + &quot;&#x27; did not exist on &quot; + target, typeof target[actionName] === &#x27;function&#x27;);
          target[actionName].apply(target, args(parameters));
        }
      });
    }
  };

  options.view.on(&#x27;willClearRender&#x27;, function() {
    delete ActionHelper.registeredActions[actionId];
  });

  return actionId;
};

/**
  The &#x60;{{action}}&#x60; helper registers an HTML element within a template for DOM
  event handling and forwards that interaction to the templates&#x27;s controller
  or supplied &#x60;target&#x60; option (see &#x27;Specifying a Target&#x27;).

  If the controller does not implement the event, the event is sent
  to the current route, and it bubbles up the route hierarchy from there.

  User interaction with that element will invoke the supplied action name on
  the appropriate target. Specifying a non-quoted action name will result in
  a bound property lookup at the time the event will be triggered.

  Given the following application Handlebars template on the page

  &#x60;&#x60;&#x60;handlebars
  &lt;div {{action &#x27;anActionName&#x27;}}&gt;
    click me
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  And application code

  &#x60;&#x60;&#x60;javascript
  App.ApplicationController = Ember.Controller.extend({
    actions: {
      anActionName: function() {
      }
    }
  });
  &#x60;&#x60;&#x60;

  Will result in the following rendered HTML

  &#x60;&#x60;&#x60;html
  &lt;div class=&quot;ember-view&quot;&gt;
    &lt;div data-ember-action=&quot;1&quot;&gt;
      click me
    &lt;/div&gt;
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  Clicking &quot;click me&quot; will trigger the &#x60;anActionName&#x60; action of the
  &#x60;App.ApplicationController&#x60;. In this case, no additional parameters will be passed.

  If you provide additional parameters to the helper:

  &#x60;&#x60;&#x60;handlebars
  &lt;button {{action &#x27;edit&#x27; post}}&gt;Edit&lt;/button&gt;
  &#x60;&#x60;&#x60;

  Those parameters will be passed along as arguments to the JavaScript
  function implementing the action.

  ### Event Propagation

  Events triggered through the action helper will automatically have
  &#x60;.preventDefault()&#x60; called on them. You do not need to do so in your event
  handlers. If you need to allow event propagation (to handle file inputs for
  example) you can supply the &#x60;preventDefault=false&#x60; option to the &#x60;{{action}}&#x60; helper:

  &#x60;&#x60;&#x60;handlebars
  &lt;div {{action &quot;sayHello&quot; preventDefault=false}}&gt;
    &lt;input type=&quot;file&quot; /&gt;
    &lt;input type=&quot;checkbox&quot; /&gt;
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  To disable bubbling, pass &#x60;bubbles=false&#x60; to the helper:

  &#x60;&#x60;&#x60;handlebars
  &lt;button {{action &#x27;edit&#x27; post bubbles=false}}&gt;Edit&lt;/button&gt;
  &#x60;&#x60;&#x60;

  If you need the default handler to trigger you should either register your
  own event handler, or use event methods on your view class. See [Ember.View](/api/classes/Ember.View.html)
  &#x27;Responding to Browser Events&#x27; for more information.

  ### Specifying DOM event type

  By default the &#x60;{{action}}&#x60; helper registers for DOM &#x60;click&#x60; events. You can
  supply an &#x60;on&#x60; option to the helper to specify a different DOM event name:

  &#x60;&#x60;&#x60;handlebars
  &lt;div {{action &quot;anActionName&quot; on=&quot;doubleClick&quot;}}&gt;
    click me
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  See &#x60;Ember.View&#x60; &#x27;Responding to Browser Events&#x27; for a list of
  acceptable DOM event names.

  NOTE: Because &#x60;{{action}}&#x60; depends on Ember&#x27;s event dispatch system it will
  only function if an &#x60;Ember.EventDispatcher&#x60; instance is available. An
  &#x60;Ember.EventDispatcher&#x60; instance will be created when a new &#x60;Ember.Application&#x60;
  is created. Having an instance of &#x60;Ember.Application&#x60; will satisfy this
  requirement.

  ### Specifying whitelisted modifier keys

  By default the &#x60;{{action}}&#x60; helper will ignore click event with pressed modifier
  keys. You can supply an &#x60;allowedKeys&#x60; option to specify which keys should not be ignored.

  &#x60;&#x60;&#x60;handlebars
  &lt;div {{action &quot;anActionName&quot; allowedKeys=&quot;alt&quot;}}&gt;
    click me
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  This way the &#x60;{{action}}&#x60; will fire when clicking with the alt key pressed down.

  Alternatively, supply &quot;any&quot; to the &#x60;allowedKeys&#x60; option to accept any combination of modifier keys.

  &#x60;&#x60;&#x60;handlebars
  &lt;div {{action &quot;anActionName&quot; allowedKeys=&quot;any&quot;}}&gt;
    click me with any key pressed
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  ### Specifying a Target

  There are several possible target objects for &#x60;{{action}}&#x60; helpers:

  In a typical Ember application, where views are managed through use of the
  &#x60;{{outlet}}&#x60; helper, actions will bubble to the current controller, then
  to the current route, and then up the route hierarchy.

  Alternatively, a &#x60;target&#x60; option can be provided to the helper to change
  which object will receive the method call. This option must be a path
  to an object, accessible in the current context:

  &#x60;&#x60;&#x60;handlebars
  {{! the application template }}
  &lt;div {{action &quot;anActionName&quot; target=view}}&gt;
    click me
  &lt;/div&gt;
  &#x60;&#x60;&#x60;

  &#x60;&#x60;&#x60;javascript
  App.ApplicationView = Ember.View.extend({
    actions: {
      anActionName: function(){}
    }
  });

  &#x60;&#x60;&#x60;

  ### Additional Parameters

  You may specify additional parameters to the &#x60;{{action}}&#x60; helper. These
  parameters are passed along as the arguments to the JavaScript function
  implementing the action.

  &#x60;&#x60;&#x60;handlebars
  {{#each person in people}}
    &lt;div {{action &quot;edit&quot; person}}&gt;
      click me
    &lt;/div&gt;
  {{/each}}
  &#x60;&#x60;&#x60;

  Clicking &quot;click me&quot; will trigger the &#x60;edit&#x60; method on the current controller
  with the value of &#x60;person&#x60; as a parameter.

  @method action
  @for Ember.Handlebars.helpers
  @param {String} actionName
  @param {Object} [context]*
  @param {Hash} options
*/
function actionHelper(actionName) {
  var options = arguments[arguments.length - 1],
      contexts = a_slice.call(arguments, 1, -1);

  var hash = options.hash,
      controller = options.data.keywords.controller;

  // create a hash to pass along to registerAction
  var action = {
    eventName: hash.on || &quot;click&quot;,
    parameters: {
      context: this,
      options: options,
      params: contexts
    },
    view: options.data.view,
    bubbles: hash.bubbles,
    preventDefault: hash.preventDefault,
    target: { options: options },
    boundProperty: options.types[0] === &quot;ID&quot;
  };

  if (hash.target) {
    action.target.root = this;
    action.target.target = hash.target;
  } else if (controller) {
    action.target.root = controller;
  }

  var actionId = ActionHelper.registerAction(actionName, action, hash.allowedKeys);
  return new SafeString(&#x27;data-ember-action=&quot;&#x27; + actionId + &#x27;&quot;&#x27;);
};

export {ActionHelper, actionHelper};

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
